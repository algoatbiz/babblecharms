var body=document.body,header=document.getElementById("header"),topbar=document.getElementById("topbar"),navigation=document.getElementById("nav-wrap"),menu=document.getElementById("menu"),mobileMenu=document.getElementById("mobile-menu"),desktopLinks=document.querySelectorAll("#menu .has-children > a"),paymentDetails=document.getElementById("payment-details"),main=document.getElementById("main");function newAx(){return axios.create({headers:{"X-Requested-With":"XMLHttpRequest"}})}var ax=newAx(),mobile=isMobile();function isMobile(){return!!new MobileDetect(window.navigator.userAgent).mobile()}body.className+=" "+(mobile?"mobile":"desktop");var phone=window.innerWidth<480,ua=window.navigator.userAgent,msie=ua.indexOf("MSIE "),edge=ua.indexOf("Edge/"),trident=ua.indexOf("Trident/"),version=parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);body.className+=trident>0||msie>0?" ie":edge>0?" edge":"";for(var i=0;i<desktopLinks.length;i++)desktopLinks[i].addEventListener("click",toggleMenu);function toggleMenu(e){if("#"!==e.currentTarget.getAttribute("href"))return!0;e.preventDefault();var t=this.nextSibling,n="block"==window.getComputedStyle(t).display?"slideUp":"slideDown";closeMenu(this,this.parentNode.parentNode),Velocity(t,n,{duration:150}),this.parentNode.classList.toggle("open")}function closeMenu(e,t){var n=t.querySelector(".open > a");if(n&&n!==e){Velocity(n.nextSibling,"slideUp",{duration:150}),n.parentNode.classList.remove("open");var o=n.nextSibling.querySelector(".open > a");o&&(o.parentNode.classList.remove("open"),o.nextSibling.style.display="none")}}body.addEventListener("click",function(e){!(!!menu&&menu.contains(e.target))&&menu&&closeMenu(this,menu)});var productCategoryLinks=document.querySelectorAll(".product-submenu a");for(i=0;i<productCategoryLinks.length;i++)productCategoryLinks[i].addEventListener("mouseover",function(){document.querySelector(".product-submenu .product-image").style="background-image: url('"+this.dataset.image+"')"});var products=document.querySelectorAll("body.product .photo-container img");if(products.length>0)for(i=0;i<products.length;i++)products[i].addEventListener("mouseover",function(){document.querySelector("body.product .photo-container").style.backgroundImage='url("'+this.src+'")'});var galleryContainer=document.querySelector("body#photo-gallery #gallery-container");if(galleryContainer){var images=galleryContainer.querySelectorAll("figure");for(i=0;i<images.length;i++)images[i].addEventListener("click",function(){setBigImage(this)});var nextPrev=galleryContainer.querySelectorAll(".next, .prev");for(i=0;i<nextPrev.length;i++)nextPrev[i].addEventListener("click",function(){var e=parseInt(galleryContainer.querySelector(".current").dataset.index);e="next"==this.className?(e+1)%images.length:0==e?images.length-1:e-1,setBigImage(images[e])})}function setBigImage(e){galleryContainer.querySelector(".current").className="",galleryContainer.querySelector("div:first-child").style.backgroundImage="url("+e.querySelector("img").src+")",e.className="current"}function initMap(){var e=new google.maps.LatLng(40.59649659999999,-112.48481989999999),t={zoom:17,streetViewControl:!1,scaleControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,center:e,disableDefaultUI:!0},n=new google.maps.Map(document.getElementById("map"),t);new google.maps.Marker({position:e,map:n})}var forms=document.querySelectorAll("form:not(#search)");if(forms.length>0)for(i=0;i<forms.length;i++)forms[i].addEventListener("submit",function(e){e.preventDefault();var t=this,n=getFormValues(t),o=t.querySelector("#form-message");n.c_time=performance.now()>=7e3?0:1,n.form_id=t.id,t.querySelector("button").className+=" disable","checkout-process"==t.id&&loading(!0),ax.post(t.action,formDataAjax(n)).then(function(e){clearErrors(t),o&&(o.innerHTML=e.data.message,o.className="success"),"checkout-process"==t.id&&(deleteCookie(bagCookieName),window.location.href=e.data.checkoutUrl),t.reset(),t.querySelector("button").classList.remove("disable")}).catch(function(e){clearErrors(t),setErrors(t,e.response.data),o&&(o.innerHTML=e.response.data.message,o.className="error"),t.querySelector("button").classList.remove("disable")})});function formDataAjax(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return t}function getFormValues(e){for(var t={},n=["INPUT","TEXTAREA","SELECT"],o=0;o<n.length;o++)getInputValues(e,t,n[o]);return t}function getInputValues(e,t,n){for(var o=e.getElementsByTagName(n),a=o.length-1;a>=0;a--)o[a].name.length&&(t[o[a].name]="checkbox"!=o[a].type||"Yes"!=o[a].value||o[a].checked?o[a].value:"No");return t}function clearErrors(e){for(var t=e.getElementsByClassName("error"),n=t.length-1;n>=0;n--)t[n].className=t[n].className.replace(" error","")}function setErrors(e,t){for(var n in t.errors){var o=e.querySelector("#"+n);o&&(o.className+=" error")}}var search=document.getElementById("search");search&&search.addEventListener("submit",function(e){""===this.querySelector("input").value&&e.preventDefault()});var bagCookieName="shopping-bag",shoppingBag=document.querySelector("#shopping-bag span"),addToBagButton=document.querySelectorAll(".add-bag:not(.added)"),selectQty=document.querySelector(".buy-container .select-container select");if(addToBagButton.length>0)for(i=0;i<addToBagButton.length;i++)addToBagButton[i].addEventListener("click",function(e){e.preventDefault();var t=this.classList.contains("single");updateCartCookie(this.getAttribute("product-id"),!!t&&this),this.classList.contains("update")&&""===selectQty.value?(this.innerHTML="Add to bag",this.classList.remove("update"),shoppingBag.innerHTML=parseInt(shoppingBag.innerHTML)-1):this.classList.contains("update")||(this.innerHTML=(t?"Update":"Added to")+" bag",this.className+=t?" update":" added",shoppingBag.innerHTML=parseInt(shoppingBag.innerHTML)+1)});function updateCartCookie(e,t){var n=getCookie(bagCookieName),o=n?JSON.parse(n):{};if(selectQty=!(!t||selectQty!=t.nextSibling.querySelector("select"))&&selectQty,t&&t.classList.contains("remove")||selectQty&&""===selectQty.value)delete o[e];else{var a=o[e]?parseInt(o[e]):1,r=t?t.classList.contains("add")?a+1:selectQty&&selectQty.value?selectQty.value:a-1:a;o[e]=r}return document.cookie=bagCookieName+"="+JSON.stringify(o)+";path=/",r}function deleteCookie(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return!1}var qtyButtons=document.querySelectorAll(".quantity-buttons a");if(qtyButtons.length>0)for(i=0;i<qtyButtons.length;i++)qtyButtons[i].addEventListener("click",function(e){e.preventDefault(),loading(!0);var t=this.parentNode.dataset.productId,n=document.querySelector("li.product-"+t);qty=updateCartCookie(t,this),data={},n.querySelector(".quantity").innerHTML=qty,data.product_id=t,data.quantity=qty,ax.post("cart-process",formDataAjax(data)).then(function(e){n.querySelector(".total-price").innerHTML=e.data.product_total,document.querySelector("#subtotal span").innerHTML=e.data.subtotal,document.querySelector("#sales-tax span").innerHTML=e.data.sales_tax,document.querySelector("#total span").innerHTML=e.data.total,loading(!1),qty>1&&!e.data.max?n.querySelector(".quantity-buttons .disabled").classList.remove("disabled"):1==qty?n.querySelector(".quantity-buttons .decrease").className+=" disabled":e.data.max&&(n.querySelector(".quantity-buttons .add").className+=" disabled")}).catch(function(e){console.log(e.error)})});var remove=document.querySelectorAll("#cart-list .remove");if(remove.length>0)for(i=0;i<remove.length;i++)remove[i].addEventListener("click",function(e){e.preventDefault(),loading(!0);var t=this.dataset.productId,n=document.querySelector("li.product-"+t);updateCartCookie(t,this),ax.post("cart-process").then(function(e){(empty_bag_msg=e.data.empty_bag_msg)?(document.querySelector("main").className="empty-bag",document.querySelector("main .container").innerHTML="<h2>"+empty_bag_msg+"</h2>"):(document.querySelector("#subtotal span").innerHTML=e.data.subtotal,document.querySelector("#total span").innerHTML=e.data.total,document.querySelector("#sales-tax span").innerHTML=e.data.sales_tax,n.parentNode.removeChild(n)),loading(!1)}).catch(function(e){console.log(e.error)})});var shipping_methods=document.querySelectorAll('input[name="shipping_method"]');if(shipping_methods.length>0)for(i=0;i<shipping_methods.length;i++)shipping_methods[i].addEventListener("change",function(){loading(!0),document.cookie="shipping-method="+this.value+";path=/",ax.post("cart-process").then(function(e){document.getElementById("subtotal").innerHTML=e.data.subtotal,loading(!1)}).catch(function(e){console.log(e.error)})});function loading(e){document.getElementById("loading").style.display=e?"block":"none"}var useShippingCheckbox=document.getElementById("use-shipping");useShippingCheckbox&&useShippingCheckbox.addEventListener("change",function(){if(loading(!0),this.checked)for(var e=document.getElementById("shipping-information"),t=["INPUT","TEXTAREA","SELECT"],n=0;n<t.length;n++)for(var o=e.getElementsByTagName(t[n]),a=o.length-1;a>=0;a--){var r=document.getElementById("billing_"+o[a].name);r&&(r.value=o[a].value)}else paymentDetails.reset();setTimeout(function(){loading(!1)},2e3)});var signup_links=document.querySelectorAll(".signup-link"),signup_popup=document.getElementById("popup-signup");if(signup_links.length>0)for(i=0;i<signup_links.length;i++)signup_links[i].addEventListener("click",togglePopup);function togglePopup(e){e.preventDefault();var t=window.getComputedStyle(signup_popup),n={duration:250,display:"none"===t.display?"block":"none"};Velocity(signup_popup,{opacity:"none"===t.display?[1,0]:[0,1]},n)}body.addEventListener("click",function(e){var t=document.querySelector("#popup-signup > div"),n=document.querySelector("#popup-signup .close");!signup_popup||"block"!==window.getComputedStyle(signup_popup).display||e.target!=n&&t.contains(e.target)||togglePopup(e)});